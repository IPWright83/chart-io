<!--- Scatters.stories.mdx --->

import { Meta, Story, Canvas } from "@storybook/addon-docs/blocks";

import { commonDefaultArgs } from "../../../../stories/commonDefaultArgs";
import { seriesArgTypes } from "../../../../stories/seriesArgTypes";
import { commonDefaultArgTypes } from "../../../../stories/commonDefaultArgTypes";
import { sales_records_dataset } from "../../../../data/sales_records_dataset";
import { huge_data_set } from "../../../../data/huge_data_set";
import { Scatter } from "./Scatter";
import { Scatters } from "./Scatters";
import { Chart } from "../../Chart";
import { XAxis, YAxis } from "../../Axis";

export const scatterArgTypes = {
    ...commonDefaultArgTypes,
    x: seriesArgTypes,
    y: seriesArgTypes,
    radius: {
        description: "The radius of each point",
        control: { type: "range", min: 1, max: 25 },
        defaultValue: { summary: 5 },
    },
};

export const scattersArgTypes = {
    ...scatterArgTypes,
    y2: seriesArgTypes,
    y3: seriesArgTypes,
};

export const defaultArgs = {
    ...commonDefaultArgs,
    y: "Total Profit",
    x: "Units Sold",
};

<Meta title="XYCharts/Scatter Plot" component={Scatter} argTypes={scatterArgTypes} />

export const ScatterTemplate = (args) => (
    <Chart {...args} data={sales_records_dataset}>
        <Scatter
            x={args.x}
            y={args.y}
            radius={args.radius}
            color={args.color}
            animationDuration={args.animationDuration}
        />
        <YAxis fields={[args.y, args.y2, args.y3]} />
        <XAxis fields={[args.x]} />
    </Chart>
);

# Scatter Component

The `<Scatter>` component allows us to define a scatter plot on our chart.

<Story
    name="Basic Scatter"
    args={{
        ...defaultArgs,
        radius: 5,
    }}
>
    {ScatterTemplate.bind({})}
</Story>

## Visual Styling

Most of the configuration for a `<Scatter>` is similar to other plots. The main styling properties are that of a `radius` property allowing us to adjust the size of the points and a colour option.

<Canvas>
    <Story
        name="Radius configuration"
        args={{
            ...defaultArgs,
            width: 400,
            radius: 3,
        }}
    >
        {ScatterTemplate.bind({})}
    </Story>
    <Story
        name="Color configuration"
        args={{
            ...defaultArgs,
            width: 400,
            radius: 8,
            color: "orange",
        }}
    >
        {ScatterTemplate.bind({})}
    </Story>
</Canvas>

## Multiple Series

There are two ways to go about defining multiple scatter plots. The simplest way is to use the `<Scatters>` (plural) component. The `<Scatters>` component allows us to define multiple series at once and takes care of automaticallying layering and assigning colors.

The long hand way is to define each `<Scatter>`, and configure with a colour manually. The only advantage to this approach is if you wish to control other settings (such as radius or events) differently between the plots.

The results of either approach, render in exactly the same way:

export const ScattersTemplate = (args) => (
    <Chart {...args} data={sales_records_dataset}>
        <Scatters
            x={args.x}
            ys={[args.y, args.y2, args.y3]}
            radius={args.radius}
            animationDuration={args.animationDuration}
        />
        <YAxis fields={[args.y, args.y2, args.y3]} />
        <XAxis fields={[args.x]} />
    </Chart>
);

export const MultipleScatterTemplate = (args) => (
    <Chart {...args} data={sales_records_dataset}>
        <Scatter
            x={args.x}
            y={args.y}
            radius={args.radius}
            color={args.color}
            animationDuration={args.animationDuration}
        />
        <Scatter
            x={args.x}
            y={args.y2}
            radius={args.radius}
            color={args.color2}
            animationDuration={args.animationDuration}
        />
        <Scatter
            x={args.x}
            y={args.y3}
            radius={args.radius}
            color={args.color3}
            animationDuration={args.animationDuration}
        />
        <YAxis fields={[args.y, args.y2, args.y3]} />
        <XAxis fields={[args.x]} />
    </Chart>
);

<Canvas>
    <Story
        name="Multiple Series - Scatters"
        args={{
            ...defaultArgs,
            width: 400,
            radius: 5,
            y2: "Total Revenue",
            y3: "Total Cost",
        }}
    >
        {ScattersTemplate.bind({})}
    </Story>
    <Story
        name="Multiple Series - Scatter"
        args={{
            ...defaultArgs,
            width: 400,
            radius: 5,
            y2: "Total Revenue",
            y3: "Total Cost",
        }}
    >
        {ScattersTemplate.bind({})}
    </Story>
</Canvas>

## Progressive Rendering

When dealing with large datasets, it's important to ensure that the browser remains responsive. Rendering lots of SVG elements or even drawing to the Canvas can significantly degrade the experience. Therefore an automatic progressive rendering approach is used.

This kicks in, only when the `useCanvas` flag is set to true and the count of data points is over a set threshold. Animations are disabled, and instead points are rendered progressively in batches.

export const ProgressiveScatterTemplate = (args) => (
    <Chart {...args} data={huge_data_set}>
        <Scatter
            x={args.x}
            y={args.y}
            radius={args.radius}
            color={args.color}
            animationDuration={args.animationDuration}
        />
        <YAxis fields={[args.y, args.y2, args.y3]} />
        <XAxis fields={[args.x]} />
    </Chart>
);

<Canvas>
    <Story
        name="Progressive Rendering"
        args={{
            ...defaultArgs,
            useCanvas: true,
            width: 400,
            radius: 3,
        }}
    >
        {ProgressiveScatterTemplate.bind({})}
    </Story>
</Canvas>

#### Scale

It is however important to remember whichever approach you use to insert any additional keys that you are using into your `<YAxis>` or `<YScale>` component.

`<YAxis fields={["Total Profit", "Total Revenue", "Total Cost"]} />`
